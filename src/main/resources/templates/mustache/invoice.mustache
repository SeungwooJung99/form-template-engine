<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{documentType}} - {{invoiceNumber}}</title>
    <style>
        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 20px; color: #333; }
        .invoice-container { max-width: 800px; margin: 0 auto; background: white; }
        .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 3px solid #2c3e50; }
        .company-info { flex: 1; }
        .company-name { font-size: 28px; font-weight: bold; color: #2c3e50; margin: 0; }
        .company-details { margin-top: 10px; color: #666; line-height: 1.5; }
        .invoice-info { text-align: right; }
        .invoice-title { font-size: 32px; font-weight: bold; color: #e74c3c; margin: 0; }
        .invoice-number { font-size: 18px; color: #666; margin: 5px 0; }
        .billing-section { display: flex; justify-content: space-between; margin: 30px 0; }
        .billing-info { flex: 1; padding: 20px; margin-right: 20px; background-color: #f8f9fa; border-radius: 8px; }
        .billing-info:last-child { margin-right: 0; }
        .billing-title { font-weight: bold; color: #2c3e50; margin-bottom: 10px; font-size: 16px; }
        .billing-details { line-height: 1.6; }
        .items-table { width: 100%; border-collapse: collapse; margin: 30px 0; }
        .items-table th { background-color: #34495e; color: white; padding: 15px; text-align: left; font-weight: bold; }
        .items-table td { padding: 12px 15px; border-bottom: 1px solid #eee; }
        .items-table tr:hover { background-color: #f8f9fa; }
        .quantity, .rate, .amount { text-align: right; }
        .totals-section { margin-top: 30px; }
        .totals-table { width: 300px; margin-left: auto; border-collapse: collapse; }
        .totals-table td { padding: 8px 15px; border-bottom: 1px solid #ddd; }
        .totals-table .total-row { background-color: #2c3e50; color: white; font-weight: bold; font-size: 18px; }
        .notes-section { margin: 30px 0; padding: 20px; background-color: #f8f9fa; border-left: 4px solid #3498db; }
        .footer { margin-top: 40px; text-align: center; padding: 20px; border-top: 1px solid #eee; color: #666; font-size: 12px; }
        .payment-info { margin: 20px 0; padding: 15px; background-color: #e8f5e8; border-radius: 5px; }
        .highlight { background-color: #fff3cd; padding: 10px; border-radius: 4px; margin: 10px 0; }
        @media print { body { margin: 0; } .invoice-container { box-shadow: none; } }
    </style>
</head>
<body>
<div class="invoice-container">
    <!-- í—¤ë” ì„¹ì…˜ -->
    <div class="header">
        <div class="company-info">
            <div class="company-name">{{company.name}}</div>
            <div class="company-details">
                {{company.address}}<br>
                {{#company.phone}}ì „í™”: {{company.phone}}<br>{{/company.phone}}
                {{#company.email}}ì´ë©”ì¼: {{company.email}}<br>{{/company.email}}
                {{#company.website}}ì›¹ì‚¬ì´íŠ¸: {{company.website}}<br>{{/company.website}}
                {{#company.businessNumber}}ì‚¬ì—…ìë²ˆí˜¸: {{company.businessNumber}}{{/company.businessNumber}}
            </div>
        </div>
        <div class="invoice-info">
            <div class="invoice-title">{{documentType}}</div>
            <div class="invoice-number">{{documentType}} ë²ˆí˜¸: {{invoiceNumber}}</div>
            <div>ë°œí–‰ì¼: {{issueDateFormatted}}</div>
            {{#dueDate}}
                <div>ì§€ë¶ˆê¸°í•œ: {{dueDateFormatted}}</div>
            {{/dueDate}}
        </div>
    </div>

    <!-- ì²­êµ¬ ì •ë³´ ì„¹ì…˜ -->
    <div class="billing-section">
        <div class="billing-info">
            <div class="billing-title">ì²­êµ¬ ëŒ€ìƒ</div>
            <div class="billing-details">
                <strong>{{client.name}}</strong><br>
                {{#client.contactPerson}}ë‹´ë‹¹ì: {{client.contactPerson}}<br>{{/client.contactPerson}}
                {{client.address}}<br>
                {{#client.phone}}ì „í™”: {{client.phone}}<br>{{/client.phone}}
                {{#client.email}}ì´ë©”ì¼: {{client.email}}<br>{{/client.email}}
                {{#client.businessNumber}}ì‚¬ì—…ìë²ˆí˜¸: {{client.businessNumber}}{{/client.businessNumber}}
            </div>
        </div>
        <div class="billing-info">
            <div class="billing-title">ë°œê¸‰ ì •ë³´</div>
            <div class="billing-details">
                <strong>ë‹´ë‹¹ì:</strong> {{salesperson}}<br>
                <strong>í”„ë¡œì íŠ¸:</strong> {{projectName}}<br>
                {{#referenceNumber}}
                    <strong>ì°¸ì¡°ë²ˆí˜¸:</strong> {{referenceNumber}}<br>
                {{/referenceNumber}}
                {{#poNumber}}
                    <strong>POë²ˆí˜¸:</strong> {{poNumber}}<br>
                {{/poNumber}}
                <strong>ê²°ì œì¡°ê±´:</strong> {{paymentTerms}}
            </div>
        </div>
    </div>

    <!-- í•­ëª© í…Œì´ë¸” -->
    <table class="items-table">
        <thead>
        <tr>
            <th style="width: 50%;">í’ˆëª©/ì„œë¹„ìŠ¤</th>
            <th style="width: 15%;" class="quantity">ìˆ˜ëŸ‰</th>
            <th style="width: 15%;" class="rate">ë‹¨ê°€</th>
            <th style="width: 20%;" class="amount">ê¸ˆì•¡</th>
        </tr>
        </thead>
        <tbody>
        {{#items}}
            <tr>
                <td>
                    <strong>{{name}}</strong>
                    {{#description}}
                        <br><small style="color: #666;">{{description}}</small>
                    {{/description}}
                </td>
                <td class="quantity">{{quantityFormatted}}</td>
                <td class="rate">â‚©{{rateFormatted}}</td>
                <td class="amount">â‚©{{itemTotalFormatted}}</td>
            </tr>
        {{/items}}
        </tbody>
    </table>

    <!-- í•©ê³„ ì„¹ì…˜ -->
    <div class="totals-section">
        <table class="totals-table">
            <tr>
                <td><strong>ì†Œê³„</strong></td>
                <td style="text-align: right;">â‚©{{subtotalFormatted}}</td>
            </tr>
            {{#hasDiscount}}
                <tr>
                    <td>í• ì¸ {{discountType}}</td>
                    <td style="text-align: right;">-â‚©{{discountAmountFormatted}}</td>
                </tr>
            {{/hasDiscount}}
            {{#hasTax}}
                <tr>
                    <td>ë¶€ê°€ì„¸ ({{taxRate}}%)</td>
                    <td style="text-align: right;">â‚©{{taxAmountFormatted}}</td>
                </tr>
            {{/hasTax}}
            <tr class="total-row">
                <td><strong>ì´ ê¸ˆì•¡</strong></td>
                <td style="text-align: right;"><strong>â‚©{{totalAmountFormatted}}</strong></td>
            </tr>
        </table>
    </div>

    <!-- ê²°ì œ ì •ë³´ -->
    {{#paymentInfo}}
        <div class="payment-info">
            <strong>ğŸ¦ ê²°ì œ ì •ë³´</strong><br>
            {{paymentInfo}}
        </div>
    {{/paymentInfo}}

    <!-- íŠ¹ë³„ ì•ˆë‚´ì‚¬í•­ -->
    {{#notes}}
        <div class="notes-section">
            <strong>ğŸ“‹ ì•ˆë‚´ì‚¬í•­</strong><br>
            {{notes}}
        </div>
    {{/notes}}

    <!-- ì¤‘ìš” ì•ˆë‚´ -->
    <div class="highlight">
        <strong>âš ï¸ ì¤‘ìš” ì•ˆë‚´:</strong>
        ë³¸ {{documentType}}ì€ {{currentDateTime}}ì— ë°œí–‰ë˜ì—ˆìŠµë‹ˆë‹¤.
        {{#dueDate}}
            ì§€ë¶ˆê¸°í•œì€ {{dueDateFormattedKorean}}ì…ë‹ˆë‹¤.
        {{/dueDate}}
    </div>

    <!-- í‘¸í„° -->
    <div class="footer">
        <p>ë³¸ ë¬¸ì„œëŠ” ì „ìì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìœ¼ë©° ì„œëª…ì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        <p>{{company.name}} | ë¬¸ì˜: {{company.email}}</p>
    </div>
</div>
</body>
</html>